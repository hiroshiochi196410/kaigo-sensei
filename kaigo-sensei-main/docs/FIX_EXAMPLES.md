# ä¾‹æ–‡èª¤å¤‰æ›ä¿®æ­£ - å®Ÿè£…ã‚¬ã‚¤ãƒ‰

## ğŸ¯ å•é¡Œ

AIï¼ˆGPT-4o-miniï¼‰ãŒä»‹è­·ç”¨èªã‚’èª¤å¤‰æ›ï¼š
- âŒ ã€Œä¸€å£ãšã¤ã€â†’ã€Œã„ã£ã“ããšã¤ã€
- âœ… æ­£ã—ãã¯ã€Œã²ã¨ãã¡ãšã¤ã€

---

## ğŸ”§ è§£æ±ºç­–ï¼ˆ2æ®µéšï¼‰

### è§£æ±ºç­–1: è¾æ›¸è¿½åŠ ï¼ˆå¿…é ˆãƒ»å³åŠ¹æ€§ã‚ã‚Šï¼‰

**æ‰€è¦æ™‚é–“: 5åˆ†**

#### ã‚¹ãƒ†ãƒƒãƒ—1: chat.jsã‚’ç½®ãæ›ãˆ

```bash
# ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«
api/chat.js

# æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«
chat.jsï¼ˆæä¾›æ¸ˆã¿ï¼‰

# ç½®ãæ›ãˆ
cp chat.js api/chat.js
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: Vercelã«å†ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
git add api/chat.js
git commit -m "Fix: ä»‹è­·ç”¨èªã®æ­£ç¢ºãªèª­ã¿æ–¹ã‚’è¾æ›¸ã§æŒ‡å®š"
git push

# VercelãŒè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆ2-3åˆ†ï¼‰
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: å‹•ä½œç¢ºèª

```
1. ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€Œä¸€å£ãšã¤ã„ãã¾ã™ã­ã€ã¨å…¥åŠ›
3. çµæœã‚’ç¢ºèª:
   âœ… ã²ã¨ãã¡ãšã¤ã„ãã¾ã™ã­ï¼ˆæ­£ã—ã„ï¼‰
   âŒ ã„ã£ã“ããšã¤ã„ãã¾ã™ã­ï¼ˆèª¤ã‚Šï¼‰
```

**åŠ¹æœ:**
- âœ… ä¸»è¦ãªä»‹è­·ç”¨èª100èªä»¥ä¸ŠãŒæ­£ç¢ºã«å¤‰æ›
- âœ… 90%ä»¥ä¸Šã®å•é¡ŒãŒè§£æ±º

---

### è§£æ±ºç­–2: æ¤œè¨¼æ¸ˆã¿ä¾‹æ–‡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆæ¨å¥¨ãƒ»å®Œç’§ãªç²¾åº¦ï¼‰

**æ‰€è¦æ™‚é–“: 30åˆ†**

ã‚ˆãä½¿ã†ä¾‹æ–‡ã‚’äº‹å‰æ¤œè¨¼æ¸ˆã¿ã¨ã—ã¦ä¿å­˜ã—ã€AIã«é ¼ã‚‰ãšæ­£ç¢ºãªå¤‰æ›ã‚’è¿”ã™ã€‚

#### ã‚¹ãƒ†ãƒƒãƒ—1: verified-phrases.jsonã‚’è¿½åŠ 

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«é…ç½®
cp verified-phrases.json api/verified-phrases.json
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: chat.jsã‚’æ‹¡å¼µç‰ˆã«ç½®ãæ›ãˆ

```javascript
// api/chat.js ã®å†’é ­ã«è¿½åŠ 
import fs from 'fs';
import path from 'path';

// æ¤œè¨¼æ¸ˆã¿ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’èª­ã¿è¾¼ã¿
const verifiedPhrasesPath = path.join(process.cwd(), 'api', 'verified-phrases.json');
const verifiedPhrasesData = fs.readFileSync(verifiedPhrasesPath, 'utf8');
const verifiedPhrases = JSON.parse(verifiedPhrasesData);

// handleré–¢æ•°ã®æœ€åˆã«ä¾‹æ–‡ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ 
export default async function handler(req, res) {
  try {
    const { prompt, meta } = req.body || {};
    const scene = meta?.scene || "bath";
    
    // æ¤œè¨¼æ¸ˆã¿ä¾‹æ–‡ã‚’å„ªå…ˆãƒã‚§ãƒƒã‚¯
    const verifiedMatch = findVerifiedPhrase(prompt, scene);
    if (verifiedMatch) {
      return res.status(200).json({
        user: {
          hira: verifiedMatch.hira,
          romaji: verifiedMatch.romaji,
          id: verifiedMatch.indonesian
        },
        ai: {
          hira: "ã¯ã„ã€ã‚ã‹ã‚Šã¾ã—ãŸ",
          romaji: "hai, wakarimashita",
          id: "Ya, saya mengerti"
        },
        feedback_jp: "å®Œç’§ãªè¡¨ç¾ã§ã™ã€‚",
        score: { scene_skill: 5 },
        trace: { verified: true }
      });
    }
    
    // é€šå¸¸ã®AIå‡¦ç†ã«ç¶šã...
  }
}

// é¡ä¼¼åº¦åˆ¤å®šé–¢æ•°
function findVerifiedPhrase(input, scene) {
  const phrases = verifiedPhrases.verified_phrases[scene] || [];
  
  for (const phrase of phrases) {
    // é¡ä¼¼åº¦80%ä»¥ä¸Šã§ä¸€è‡´
    if (isSimilar(input, phrase.japanese) ||
        isSimilar(input, phrase.hira) ||
        isSimilar(input, phrase.romaji) ||
        isSimilar(input, phrase.indonesian)) {
      return phrase;
    }
  }
  return null;
}

function isSimilar(str1, str2) {
  const s1 = str1.toLowerCase().replace(/\s+/g, '');
  const s2 = str2.toLowerCase().replace(/\s+/g, '');
  return s1 === s2 || s1.includes(s2) || s2.includes(s1);
}
```

#### ã‚¹ãƒ†ãƒƒãƒ—3: ä¾‹æ–‡ã‚’è¿½åŠ 

verified-phrases.json ã«é »å‡ºãƒ•ãƒ¬ãƒ¼ã‚ºã‚’è¿½åŠ ï¼š

```json
{
  "verified_phrases": {
    "meal": [
      {
        "japanese": "ä¸€å£ãšã¤ã„ãã¾ã™ã­",
        "hira": "ã²ã¨ãã¡ãšã¤ã„ãã¾ã™ã­",
        "romaji": "hitokuchi zutsu ikimasu ne",
        "indonesian": "Saya akan memberi satu suapan setiap kali",
        "scene": "meal"
      }
      // ... ä»–ã®ä¾‹æ–‡
    ]
  }
}
```

#### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ç¢ºèª

```bash
git add api/chat.js api/verified-phrases.json
git commit -m "Add: æ¤œè¨¼æ¸ˆã¿ä¾‹æ–‡ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½"
git push
```

**åŠ¹æœ:**
- âœ… ã‚ˆãä½¿ã†ä¾‹æ–‡ã¯100%æ­£ç¢º
- âœ… AIå‡¦ç†ãŒä¸è¦ï¼ˆé«˜é€Ÿãƒ»ä½ã‚³ã‚¹ãƒˆï¼‰
- âœ… ä¾‹æ–‡ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ç²¾åº¦å‘ä¸Š

---

## ğŸ“Š æ”¹å–„åŠ¹æœã®æ¯”è¼ƒ

| æ–¹æ³• | ç²¾åº¦ | é€Ÿåº¦ | ã‚³ã‚¹ãƒˆ | å®Ÿè£…æ™‚é–“ |
|------|------|------|--------|---------|
| ç¾åœ¨ï¼ˆè¾æ›¸ãªã—ï¼‰ | 70% | 1.5ç§’ | Â¥0.35/å› | - |
| è§£æ±ºç­–1ï¼ˆè¾æ›¸è¿½åŠ ï¼‰ | 90% | 1.5ç§’ | Â¥0.35/å› | 5åˆ† |
| è§£æ±ºç­–2ï¼ˆä¾‹æ–‡ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰ | 100% | 0.2ç§’ | Â¥0/å› | 30åˆ† |

---

## ğŸ¯ æ¨å¥¨å®Ÿè£…é †åº

### Phase 1ï¼ˆä»Šã™ãï¼‰: è¾æ›¸è¿½åŠ 
```
âœ… chat.jsã‚’ç½®ãæ›ãˆ
âœ… Vercelã«å†ãƒ‡ãƒ—ãƒ­ã‚¤
âœ… å‹•ä½œç¢ºèª

æ‰€è¦æ™‚é–“: 5åˆ†
åŠ¹æœ: 90%ã®å•é¡Œè§£æ±º
```

### Phase 2ï¼ˆä»Šé€±ä¸­ï¼‰: ä¾‹æ–‡ã‚­ãƒ£ãƒƒã‚·ãƒ¥
```
âœ… verified-phrases.jsonã‚’ä½œæˆ
âœ… é »å‡º50ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—
âœ… chat.jsã«æ¤œç´¢æ©Ÿèƒ½è¿½åŠ 
âœ… ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»æ¤œè¨¼

æ‰€è¦æ™‚é–“: 2-3æ™‚é–“
åŠ¹æœ: ã‚ˆãä½¿ã†ä¾‹æ–‡ã¯100%æ­£ç¢º
```

---

## ğŸ“ ä¾‹æ–‡ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã®ãƒ’ãƒ³ãƒˆ

### ã‚ˆãä½¿ã†ä¾‹æ–‡ã®èª¿æŸ»æ–¹æ³•

#### 1. ãƒ­ã‚°ã‹ã‚‰æŠ½å‡º
```javascript
// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›å±¥æ­´ã‚’åˆ†æ
const topPhrases = analyzeUserInput();
// ä¸Šä½50ä»¶ã‚’ä¾‹æ–‡åŒ–
```

#### 2. ä»‹è­·ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‹ã‚‰
```
- åšç”ŸåŠ´åƒçœã®ä»‹è­·ãƒãƒ‹ãƒ¥ã‚¢ãƒ«
- æŠ€èƒ½å®Ÿç¿’ç”Ÿå‘ã‘æ•™æ
- EPAå€™è£œè€…å‘ã‘ãƒ†ã‚­ã‚¹ãƒˆ
```

#### 3. ã‚·ãƒ¼ãƒ³åˆ¥ã«æ•´ç†
```
é£Ÿäº‹: 20å€‹
å…¥æµ´: 15å€‹
æ’æ³„: 10å€‹
å¤œé–“: 5å€‹
ã‚¯ãƒ¬ãƒ¼ãƒ : 5å€‹
â”â”â”â”â”â”â”â”
åˆè¨ˆ: 55å€‹
```

---

## âš ï¸ æ³¨æ„äº‹é …

### è¾æ›¸ã®æ›´æ–°

æ–°ã—ã„èª¤å¤‰æ›ã‚’ç™ºè¦‹ã—ãŸã‚‰ã€KAIGO_DICTIONARYã«è¿½åŠ ï¼š

```javascript
const KAIGO_DICTIONARY = `
// æ—¢å­˜ã®è¾æ›¸
ä¸€å£ãšã¤ â†’ ã²ã¨ãã¡ãšã¤
å°‘ã—ãšã¤ â†’ ã™ã“ã—ãšã¤

// æ–°è¦è¿½åŠ 
æ‰‹ã™ã‚Š â†’ ã¦ã™ã‚Š
æ°—ã‚’ã¤ã‘ã¦ â†’ ãã‚’ã¤ã‘ã¦
`;
```

### ä¾‹æ–‡ã®æ¤œè¨¼

verified-phrases.jsonã«è¿½åŠ ã™ã‚‹å‰ã«ï¼š
1. âœ… ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒã‚§ãƒƒã‚¯
2. âœ… è¤‡æ•°ã®è¾æ›¸ã§ç¢ºèª
3. âœ… å®Ÿéš›ã«éŸ³å£°ã§èã„ã¦ã¿ã‚‹

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **ä»Šã™ã**: è§£æ±ºç­–1ã‚’å®Ÿè£…ï¼ˆ5åˆ†ï¼‰
2. **ä»Šé€±**: è§£æ±ºç­–2ã‚’å®Ÿè£…ï¼ˆ2-3æ™‚é–“ï¼‰
3. **ç¶™ç¶š**: ä¾‹æ–‡ã‚’å¢—ã‚„ã™ï¼ˆé€±5å€‹ãšã¤ï¼‰

---

## ğŸ“ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒã‚ã‚Œã°ä»¥ä¸‹ã®æƒ…å ±ã¨å…±ã«é€£çµ¡ï¼š
- å…¥åŠ›ã—ãŸãƒ†ã‚­ã‚¹ãƒˆ
- æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›
- å®Ÿéš›ã®å‡ºåŠ›
- ã‚·ãƒ¼ãƒ³ãƒ»ã‚«ãƒ†ã‚´ãƒª
